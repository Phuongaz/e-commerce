import{r as s,S as N,j as e,e as w,t as C,v as f,i as c,y as a}from"./index-CyFUtVx2.js";const E=()=>{const[r,d]=s.useState(null),[u,h]=s.useState(""),[p,m]=s.useState(!1),[b,n]=s.useState(!1),[g,x]=s.useState(!1),{backendUrl:o,navigate:y,loginSuccess:i}=s.useContext(N);s.useEffect(()=>{if(!i)return;(async()=>{try{const l=await c.get(`${o}/api/user/profile`,{withCredentials:!0});d(l.data)}catch{a.error("Failed to load profile. Please log in again.",{position:"top-center",autoClose:1500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"})}})()},[i]);const j=async()=>{try{const t=await c.put(`${o}/api/user/profile`,{email:u},{withCredentials:!0});a.success("Email updated successfully",{position:"top-center",autoClose:1500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),d(l=>({...l,email:t.data.updatedEmail})),m(!1)}catch{a.error("Failed to update email",{position:"top-center",autoClose:1500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"})}},v=async()=>{x(!0);try{await c.delete(`${o}/api/user/logout`,{withCredentials:!0}),setLoginSuccess(!1),a.success("Account deleted successfully",{position:"top-center",autoClose:1500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"}),n(!1),setTimeout(()=>{y("/"),window.location.reload()},1e3)}catch{a.error("Failed to delete account",{position:"top-center",autoClose:1500,hideProgressBar:!1,closeOnClick:!1,pauseOnHover:!1,draggable:!0,progress:void 0,theme:"light"})}finally{x(!1)}};return i?r?e.jsxs("div",{className:"flex items-center justify-center py-10  px-4",children:[e.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 w-full max-w-md border border-gray-200",children:[e.jsxs("h2",{className:"text-2xl font-bold text-black flex items-center gap-2 mb-6 border-b pb-4",children:[e.jsx(w,{className:"text-black"})," My Profile"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-lg font-medium flex flex-col",children:[e.jsx("span",{className:"text-gray-500",children:"Name"}),e.jsx("span",{className:"text-gray-800 bg-gray-100 font-normal p-2 rounded-md",children:r.name})]}),e.jsxs("div",{className:"text-lg font-medium flex flex-col",children:[e.jsx("span",{className:"text-gray-500",children:"Email"}),p?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"email",className:"border border-gray-300 p-2 rounded-md flex-1 focus:ring-1 focus:ring-blue-700 outline-none font-normal",value:u,onChange:t=>h(t.target.value),placeholder:"Enter new email"}),e.jsx("button",{onClick:j,className:"bg-blue-700 text-white px-3 py-2 rounded-md hover:bg-blue-800 transition font-normal",children:"Update"})]}):e.jsxs("div",{className:"flex items-center justify-between bg-gray-100 p-2 rounded-md",children:[e.jsx("span",{className:"text-gray-800 font-normal",children:r.email}),e.jsx("button",{onClick:()=>m(!0),className:"text-blue-700 hover:text-blue-900 transition",children:e.jsx(C,{})})]})]})]}),e.jsxs("button",{onClick:()=>n(!0),className:"mt-8 w-full bg-red-600 text-white px-4 py-2 rounded-md flex items-center justify-center gap-2 hover:bg-red-700 transition-all duration-200 shadow-md",children:[e.jsx(f,{})," Delete Account"]})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Are you sure?"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Do you really want to delete your account? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>n(!1),className:"px-4 py-2 bg-gray-300 rounded-md hover:bg-gray-400 transition",children:"Cancel"}),e.jsx("button",{onClick:v,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition flex items-center gap-2",disabled:g,children:g?e.jsx(e.Fragment,{children:"Deleting..."}):e.jsxs(e.Fragment,{children:[e.jsx(f,{}),"Yes, Delete"]})})]})]})})]}):e.jsx("div",{className:"text-center text-black font-semibold mt-20",children:"Loading Profile..."}):e.jsx("div",{className:"text-center text-black font-semibold mt-20",children:"Please log in to view your profile."})};export{E as default};
